{"version":3,"sources":["../../../src/tools/windows/create-shortcut.ts"],"names":["createShortcut","path","name","ico","script","scriptPath","Math","random"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;;AAQA;;;AAGO,MAAMA,cAAc,GAAG,OAAO;AAACC,EAAAA,IAAD;AAAOC,EAAAA,IAAP;AAAaC,EAAAA;AAAb,CAAP,KAAyC;AACrE;AACA,QAAMC,MAAM,GACb;;;;;uEAKsEF,IAAK;4BAChDD,IAAK;8BACHE,GAAI;;;;iBARhC;AAcA,QAAME,UAAU,GAAG,kBAAK,mBAAL,EAAgB,YAAWC,IAAI,CAACC,MAAL,EAAc,MAAzC,CAAnB;AACA,2BAAcF,UAAd,EAA0BD,MAA1B,EAAkC,OAAlC;AAEA,QAAM,uCAAeC,UAAf,CAAN;AACD,CApBM","sourcesContent":["import {writeFileSync} from 'fs';\nimport {join} from 'path';\nimport {tmpdir} from 'os';\nimport {executeCommand} from './executeWinCommand';\n\ntype LnkOptions = {\n  path: string;\n  name: string;\n  ico: string;\n};\n\n/**\n * Creates a script in the user's Startup menu\n */\nexport const createShortcut = async ({path, name, ico}: LnkOptions) => {\n  // prettier-ignore\n  const script =\n`option explicit\nsub createLnk()\n    dim objShell, strStartMenuPath, objLink\n    set objShell = CreateObject(\"WScript.Shell\")\n    strStartMenuPath = objShell.SpecialFolders(\"StartMenu\")\n    set objLink = objShell.CreateShortcut(strStartMenuPath + \"\\\\\" + \"${name}.lnk\")\n    objLink.TargetPath = \"${path}\"\n    objLink.IconLocation = \"${ico}\"\n    objLink.Save\nend sub\n\ncall createLnk()`;\n\n  const scriptPath = join(tmpdir(), `shortcut-${Math.random()}.vbs`);\n  writeFileSync(scriptPath, script, 'utf-8');\n\n  await executeCommand(scriptPath);\n};\n"]}