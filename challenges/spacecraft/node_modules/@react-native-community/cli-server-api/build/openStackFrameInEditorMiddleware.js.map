{"version":3,"sources":["../src/openStackFrameInEditorMiddleware.ts"],"names":["getOpenStackFrameInEditorMiddleware","watchFolders","req","res","next","rawBody","Error","frame","JSON","parse","file","lineNumber","end","options","use","rawBodyMiddleware"],"mappings":";;;;;;;AAOA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;;;;AATA;;;;;;AAeA,SAASA,mCAAT,CAA6C;AAACC,EAAAA;AAAD,CAA7C,EAAsE;AACpE,SAAO,CACLC,GADK,EAELC,GAFK,EAGLC,IAHK,KAIF;AACH,QAAI,CAACF,GAAG,CAACG,OAAT,EAAkB;AAChB,aAAOD,IAAI,CAAC,IAAIE,KAAJ,CAAU,sBAAV,CAAD,CAAX;AACD;;AACD,UAAMC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWP,GAAG,CAACG,OAAf,CAAd;AACA,kCAAaE,KAAK,CAACG,IAAnB,EAAyBH,KAAK,CAACI,UAA/B,EAA2CV,YAA3C;AACAE,IAAAA,GAAG,CAACS,GAAJ,CAAQ,IAAR;AACD,GAXD;AAYD;;eAEeC,OAAD,IAAsB;AACnC,SAAO,0BACJC,GADI,CACAC,0BADA,EAEJD,GAFI,CAEAd,mCAAmC,CAACa,OAAD,CAFnC,CAAP;AAGD,C","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport http from 'http';\nimport {launchEditor} from '@react-native-community/cli-tools';\nimport connect from 'connect';\nimport rawBodyMiddleware from './rawBodyMiddleware';\n\ntype Options = {\n  watchFolders: ReadonlyArray<string>;\n};\n\nfunction getOpenStackFrameInEditorMiddleware({watchFolders}: Options) {\n  return (\n    req: http.IncomingMessage & {rawBody?: string},\n    res: http.ServerResponse,\n    next: (err?: any) => void,\n  ) => {\n    if (!req.rawBody) {\n      return next(new Error('missing request body'));\n    }\n    const frame = JSON.parse(req.rawBody);\n    launchEditor(frame.file, frame.lineNumber, watchFolders);\n    res.end('OK');\n  };\n}\n\nexport default (options: Options) => {\n  return connect()\n    .use(rawBodyMiddleware)\n    .use(getOpenStackFrameInEditorMiddleware(options));\n};\n"]}